<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Stoja Trade - AI-Powered Real Estate Assistant Demo"
    />
    <title>Stoja Trade AI Assistant Demo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- ElevenLabs Widget Positioning -->
    <style>
      #elevenlabs-widget-container {
        position: fixed !important;
        left: 20px !important;
        bottom: 20px !important;
        top: auto !important;
        transform: none !important;
        z-index: 9998 !important;
        pointer-events: none !important;
      }
      
      #elevenlabs-widget-container elevenlabs-convai {
        pointer-events: auto !important;
        position: relative !important;
        display: block !important;
      }
    </style>
    <script>
      // Continuous fix that runs forever to override ElevenLabs positioning
      function forceWidgetPosition() {
        // Fix container
        const container = document.getElementById('elevenlabs-widget-container');
        if (container) {
          container.style.cssText = 'position: fixed !important; left: 20px !important; bottom: 20px !important; top: auto !important; transform: none !important; z-index: 9998 !important; pointer-events: none !important;';
        }
        
        // Fix widget element
        const widget = document.querySelector('elevenlabs-convai');
        if (widget) {
          widget.style.cssText = 'position: relative !important; display: block !important; width: auto !important; height: auto !important; min-width: 280px !important; left: auto !important; right: auto !important; top: auto !important; bottom: auto !important; transform: none !important;';
          
          // Fix shadow DOM if it exists
          if (widget.shadowRoot) {
            const shadowRoot = widget.shadowRoot;
            
            // Find ALL elements and force them to not use fixed positioning
            const allElements = shadowRoot.querySelectorAll('*');
            allElements.forEach(function(el) {
              const rect = el.getBoundingClientRect();
              const computed = window.getComputedStyle(el);
              
              // If element is off-screen (left < 0 or way off to the right) OR using fixed positioning
              if (rect.left < 0 || rect.left > window.innerWidth || computed.position === 'fixed') {
                el.style.setProperty('position', 'static', 'important');
                el.style.setProperty('left', 'auto', 'important');
                el.style.setProperty('right', 'auto', 'important');
                el.style.setProperty('top', 'auto', 'important');
                el.style.setProperty('bottom', 'auto', 'important');
                el.style.setProperty('transform', 'none', 'important');
                el.style.setProperty('margin', '0', 'important');
              }
            });
            
            // Inject CSS that forces everything to static
            let styleEl = shadowRoot.querySelector('style[data-force-position]');
            if (!styleEl) {
              styleEl = document.createElement('style');
              styleEl.setAttribute('data-force-position', 'true');
              shadowRoot.insertBefore(styleEl, shadowRoot.firstChild);
            }
            styleEl.textContent = '* { position: static !important; left: auto !important; right: auto !important; top: auto !important; bottom: auto !important; transform: none !important; }';
          }
        }
      }
      
      // Run immediately and continuously
      forceWidgetPosition();
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', forceWidgetPosition);
      }
      
      window.addEventListener('load', forceWidgetPosition);
      window.addEventListener('resize', forceWidgetPosition);
      
      // Run continuously every 100ms to override ElevenLabs script
      setInterval(forceWidgetPosition, 100);
      
      // MutationObserver on body
      const bodyObserver = new MutationObserver(forceWidgetPosition);
      bodyObserver.observe(document.body, { childList: true, subtree: true });
      
      // MutationObserver on widget shadow DOM when it exists
      function observeShadowDOM() {
        const widget = document.querySelector('elevenlabs-convai');
        if (widget && widget.shadowRoot) {
          const shadowObserver = new MutationObserver(forceWidgetPosition);
          shadowObserver.observe(widget.shadowRoot, { 
            childList: true, 
            subtree: true, 
            attributes: true,
            attributeFilter: ['style']
          });
        }
      }
      
      // Check for shadow DOM periodically
      setInterval(function() {
        observeShadowDOM();
        forceWidgetPosition();
      }, 200);
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <!-- ElevenLabs Conversational AI Widget - Wrapped in positioned container -->
    <div id="elevenlabs-widget-container" style="position: fixed; left: 20px; bottom: 20px; top: auto; transform: none; z-index: 9998; pointer-events: none;">
      <elevenlabs-convai agent-id="agent_7701k80ng0s4e9dasnydy605s42g" style="pointer-events: auto;"></elevenlabs-convai>
    </div>
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>
  </body>
</html>

